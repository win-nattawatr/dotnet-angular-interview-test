# Please refer https://aka.ms/HTTPSinContainer on how to setup an https developer certificate for your ASP.NET Core service.

version: "3.4"

services:
    backend:
        image: ${COMPOSE_PROJECT_NAME}-backend:dev
        build:
            context: ./Backend
            target: development
        ports:
            - 5000:5000
        depends_on:
            - db
        networks:
            - dev-network
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - DOTNET_USE_POLLING_FILE_WATCHER=1
            - ASPNETCORE_URLS=http://+:5000
        working_dir: /app
        volumes:
            - ./Backend:/app
            - ~/.vsdbg:/remote_debugger:rw

    frontend:
        image: ${COMPOSE_PROJECT_NAME}-frontend:dev
        build:
            context: ./Frontend
            target: development
        ports:
            - 4200:4200
        working_dir: /app
        volumes:
            - ./Frontend:/app

    db:
        image: mcr.microsoft.com/mssql/server:2022-latest
        environment:
            - ACCEPT_EULA=Y
            - SA_PASSWORD=N0tStr0ng$ecreT
        ports:
            - "1433:1433"
        volumes:
            - mssql-volume:/var/opt/mssql/data
        restart: always
        networks:
            - dev-network
        user: root

networks:
    dev-network:
        driver: bridge

volumes:
    mssql-volume:
